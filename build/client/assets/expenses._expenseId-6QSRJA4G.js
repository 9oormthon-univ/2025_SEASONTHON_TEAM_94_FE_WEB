import{j as e,u as y,a as g,r as c,w as E}from"./chunk-PVWAREVJ-B6zbi7fP.js";import{M as v}from"./httpClient-CWcscfoA.js";import{u as w}from"./useExpenses-DaQT4tNd.js";import{B as x}from"./button-Bs42eLNO.js";import{E as u}from"./expense-DPxRIikd.js";import{a as S}from"./expenseApi-6HP_E5FY.js";import"./utils-B3HXpwuO.js";function D({expense:s,onSave:a,onCancel:o,onDelete:i}){return s?e.jsx("div",{className:"max-w-xl mx-auto px-4 py-3 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"지출 상세"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"제목"}),e.jsx("p",{className:"font-semibold",children:s.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"금액"}),e.jsxs("p",{className:"font-semibold text-lg",children:[s.price.toLocaleString(),"원"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"날짜"}),e.jsx("p",{children:new Date(s.startedAt).toLocaleDateString("ko-KR")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"타입"}),e.jsx("p",{children:s.type==="FIXED_EXPENSE"?"고정지출":s.type==="OVER_EXPENSE"?"초과지출":"미분류"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"카테고리"}),e.jsx("p",{children:s.category})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-6",children:[i&&e.jsx(x,{variant:"outline",size:"sm",onClick:i,className:"text-red-600 border-red-600 hover:bg-red-50",children:"삭제"}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:o,children:"취소"}),e.jsx(x,{size:"sm",onClick:()=>a(s),children:"확인"})]})]})]})}):e.jsx("div",{className:"p-6 text-center text-muted-foreground",children:"항목을 찾을 수 없습니다."})}function C(){const{expenseId:s}=y(),a=g(),{updateExpense:o,deleteExpense:i}=w(),[n,f]=c.useState(null),[j,d]=c.useState(!0),[m,h]=c.useState(null),l=v;c.useEffect(()=>{(async()=>{if(!s){h("지출 ID가 없습니다."),d(!1);return}try{d(!0);const r=await S(l,Number(s));f(r)}catch(r){h(r instanceof Error?r.message:"지출을 불러오는데 실패했습니다.")}finally{d(!1)}})()},[s,l]);const p=async t=>{try{await o(l,t.id,{title:t.title,price:t.price,type:t.type,category:t.category,startAt:t.startedAt});const r=t.type===u.NONE?"unclassified":"classified";a(`/expenses?tab=${r}`)}catch(r){console.error("updateExpense error:",r),alert("지출 수정에 실패했습니다.")}},b=async()=>{if(n&&confirm("정말로 이 지출을 삭제하시겠습니까?"))try{await i(l,n.id),a("/expenses")}catch(t){console.error("deleteExpense error:",t),alert("지출 삭제에 실패했습니다.")}},N=()=>{const t=(n==null?void 0:n.type)===u.NONE?"unclassified":"classified";a(`/expenses?tab=${t}`)};return j?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):m?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"bg-white rounded-lg border border-red-200 p-6 max-w-md",children:e.jsxs("div",{className:"text-red-600 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⚠️"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"오류가 발생했습니다"}),e.jsx("p",{className:"text-sm mb-4",children:m}),e.jsx("button",{onClick:()=>a("/expenses"),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"목록으로 돌아가기"})]})})}):e.jsx(D,{expense:n,onSave:p,onCancel:N,onDelete:b})}const X=E(function(){return e.jsx(C,{})});export{X as default};

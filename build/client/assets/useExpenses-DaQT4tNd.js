import{r as s,j as g}from"./chunk-PVWAREVJ-B6zbi7fP.js";import{f as k,u as v,c as S,d as j}from"./expenseApi-6HP_E5FY.js";import{M as P}from"./httpClient-CWcscfoA.js";const x=s.createContext(null);function O({children:o,initialExpenses:c,userUid:l=P,defaultType:f="NONE"}){const[p,i]=s.useState(c||[]),[h,w]=s.useState(!1),[m,E]=s.useState(null),e=s.useCallback(async r=>{try{w(!0),E(null);const t={userUid:l,type:f,...r},a=await k(t);i(a)}catch(t){E(t instanceof Error?t.message:"지출 데이터를 불러오는데 실패했습니다.")}finally{w(!1)}},[l,f]),d=s.useCallback(async(r,t,a)=>{try{i(n=>n.map(u=>u.id===t?{...u,...a}:u)),await v(r,t,a),await e()}catch(n){throw await e(),n}},[e]),y=s.useCallback(async r=>{try{const t=await S(r);i(a=>[t,...a]),await e()}catch(t){throw await e(),t}},[e]),C=s.useCallback(async(r,t)=>{try{i(a=>a.filter(n=>n.id!==t)),await j(r,t),await e()}catch(a){throw await e(),a}},[e]);s.useEffect(()=>{(!c||c.length===0)&&e()},[e,c]);const b={expenses:p,loading:h,error:m,refreshExpenses:e,updateExpense:d,createExpense:y,deleteExpense:C};return g.jsx(x.Provider,{value:b,children:o})}const R=()=>{const o=s.useContext(x);if(!o)throw new Error("useExpenses must be used within an ExpenseProvider");return o};export{O as E,R as u};

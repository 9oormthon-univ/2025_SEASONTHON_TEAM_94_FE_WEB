import{j as o,r as i}from"./chunk-PVWAREVJ-B6zbi7fP.js";import{a as p}from"./utils-B3HXpwuO.js";function z({barPercent:t,percentCenterLeft:e,barLabel:a}){const s=Math.max(0,Math.min(100,t)),r=6,c=.5,m=99.5,d=s<=c,f=s>=m,h=f?-r:d?r:0,u=d?"50%":f?"-50%":"0%";return o.jsx("div",{className:"relative pt-7",children:o.jsxs("div",{className:"relative h-10 w-full rounded-lg border border-[#BFBFBF] bg-[#F4F6F8] overflow-visible",children:[o.jsx("div",{className:`h-full ${s>=100?"rounded-lg":"rounded-l-lg"}`,style:{width:`${s}%`,background:"#002B5B"}}),o.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 text-white text-xs font-normal",style:{left:`calc(${e}% )`,transform:"translate(-50%,-20%)"},children:s===0||s===100?`${s}%`:`${s.toFixed(2)}%`}),o.jsxs("div",{className:"absolute flex flex-col items-center pointer-events-none z-10",style:{left:`calc(${s}% + ${h}px)`,bottom:"100%",transform:"translate(-50%, 1px)"},children:[o.jsx("div",{className:"mb-1 whitespace-nowrap text-[11px] font-bold text-[#FF6200]",style:{transform:`translateX(${u})`},children:a}),o.jsx("div",{className:"w-[4px] h-[4px] rounded-full bg-black"}),o.jsx("div",{className:"w-px h-3 bg-black"})]})]})})}const P=i.forwardRef(({className:t,...e},a)=>o.jsx("div",{ref:a,className:p("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));P.displayName="Card";const R=i.forwardRef(({className:t,...e},a)=>o.jsx("div",{ref:a,className:p("flex flex-col space-y-1.5 p-6",t),...e}));R.displayName="CardHeader";const A=i.forwardRef(({className:t,...e},a)=>o.jsx("h3",{ref:a,className:p("text-2xl font-semibold leading-none tracking-tight",t),...e}));A.displayName="CardTitle";const _=i.forwardRef(({className:t,...e},a)=>o.jsx("p",{ref:a,className:p("text-sm text-muted-foreground",t),...e}));_.displayName="CardDescription";const k=i.forwardRef(({className:t,...e},a)=>o.jsx("div",{ref:a,className:p("p-6 pt-0",t),...e}));k.displayName="CardContent";const B=i.forwardRef(({className:t,...e},a)=>o.jsx("div",{ref:a,className:p("flex items-center p-6 pt-0",t),...e}));B.displayName="CardFooter";function K({className:t,children:e}){return o.jsx("span",{className:`whitespace-nowrap tabular-nums tracking-tight ${t??""}`,children:e})}const b=new Date,l={y:b.getFullYear(),m:b.getMonth()+1,d:b.getDate()},j=new Date(l.y,l.m-1,1),L=new Date(l.y,l.m,0),V=t=>`${t.getMonth()+1}월 ${t.getDate()}일`;function $(t){if(!t)return!1;const e=new Date(t),a=new Date(l.y,l.m-1,l.d,23,59,59);return e>=j&&e<=a}const w=t=>`${Math.floor(t).toLocaleString()}원`,G="https://api.stopusing.klr.kr";function I(t){if(!t)return"";const e=Object.entries(t).filter(([,a])=>a!=null&&a!=="").map(([a,s])=>`${encodeURIComponent(a)}=${encodeURIComponent(String(s))}`).join("&");return e?`?${e}`:""}async function U(t,e="GET",a,s){const r=await fetch(t.startsWith("http")?t:`${G}${t}`,{method:e,headers:{"Content-Type":"application/json"},body:void 0,signal:s,credentials:"omit"}),c=await r.json(),m=(c==null?void 0:c.data)??c;if(!r.ok){const d=(c==null?void 0:c.message)||`HTTP ${r.status}`;throw new Error(d)}return m}function g(t,e,a){return U(`${t}${I(e)}`,"GET",void 0,a)}const v="a",X=1;async function O(t){try{const e=await g(`/api/v1/budgetgoals/${X}`,{userUid:v},t);return Number.isFinite(e==null?void 0:e.price)?Math.max(0,e.price):0}catch{return 0}}async function C(t,e){try{return await g("/api/v1/transactions",{userUid:v,type:t},e)}catch{try{return(await g("/api/v1/transactions",{userUid:v},e)).filter(s=>s.type===t)}catch{return[]}}}function W(){const[t,e]=i.useState([]),[a,s]=i.useState([]),[r,c]=i.useState(0);i.useEffect(()=>{const n=new AbortController;return O(n.signal).then(c).catch(()=>c(0)),()=>n.abort()},[]),i.useEffect(()=>{const n=new AbortController;return(async()=>{const[x,D]=await Promise.all([C("OVER_EXPENSE",n.signal),C("FIXED_EXPENSE",n.signal)]);e(x),s(D)})(),()=>n.abort()},[]);const m=t.filter(n=>$(n.createdAt||n.startAt)),d=a.filter(n=>$(n.createdAt||n.startAt)),f=m.reduce((n,x)=>n+(x.price||0),0),h=d.reduce((n,x)=>n+(x.price||0),0),u=f+h,M=r>0?u/r*100:100,y=Math.max(0,Math.min(100,M)),F=Math.max(0,Math.min(100,y/2)),E=r>0?r-u:-f,N=r>0&&u>r,S=r>0?N?`+ ${w(Math.abs(E))}`:`- ${w(Math.abs(E))}`:`- ${w(f)}`,T=y<=12||y>=92?"translateX(calc(-100% - 6px))":"translateX(-50%)";return{ym:l,today:b,monthStart:j,monthEnd:L,monthOver:m,monthFixed:d,overSum:f,fixedSum:h,total:u,monthlyGoal:r,barPercent:y,percentCenterLeft:F,barLabel:S,labelTransform:T,isOver:N}}export{P as C,K as M,z as P,k as a,V as d,w as f,W as u};
